{
  "openapi": "3.0.3",
  "info": {
    "title": "Ecommerce SaaS Backend API",
    "version": "1.0.0",
    "description": "API documentation for the Ecommerce SaaS backend."
  },
  "servers": [
    { "url": "/api/v1" }
  ],
  "tags": [
    { "name": "Auth" },
    { "name": "Products" },
    { "name": "Categories" },
    { "name": "Subcategories" },
    { "name": "Cart" },
    { "name": "Delivery" },
    { "name": "Orders" },
    { "name": "Payments" },
    { "name": "PayFast" }
  ],
  "components": {
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      }
    },
    "schemas": {
      "User": {
        "type": "object",
        "properties": {
          "id": { "type": "string" },
          "name": { "type": "string" },
          "email": { "type": "string" },
          "role": { "type": "string" }
        }
      },
      "Product": {
        "type": "object",
        "properties": {
          "id": { "type": "string" },
          "name": { "type": "string" },
          "description": { "type": "string" },
          "price": { "type": "number" },
          "category": { "type": "string" },
          "subcategory": { "type": "string" },
          "images": { "type": "array", "items": { "type": "string", "format": "binary" } }
        }
      },
      "Category": {
        "type": "object",
        "properties": {
          "id": { "type": "string" },
          "name": { "type": "string" },
          "description": { "type": "string" }
        }
      },
      "Subcategory": {
        "type": "object",
        "properties": {
          "id": { "type": "string" },
          "name": { "type": "string" },
          "category": { "type": "string" },
          "description": { "type": "string" }
        }
      },
      "Cart": {
        "type": "object",
        "properties": {
          "user": { "type": "string" },
          "items": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "product": { "type": "string" },
                "quantity": { "type": "integer" }
              }
            }
          }
        }
      },
      "Address": {
        "type": "object",
        "properties": {
          "id": { "type": "string" },
          "user": { "type": "string" },
          "name": { "type": "string" },
          "phone": { "type": "string" },
          "street": { "type": "string" },
          "city": { "type": "string" },
          "state": { "type": "string" },
          "postalCode": { "type": "string" },
          "country": { "type": "string" },
          "isDefault": { "type": "boolean" }
        }
      },
      "DeliveryOption": {
        "type": "object",
        "properties": {
          "id": { "type": "string" },
          "name": { "type": "string" },
          "description": { "type": "string" },
          "price": { "type": "number" },
          "estimatedTime": { "type": "string" }
        }
      },
      "Order": {
        "type": "object",
        "properties": {
          "id": { "type": "string" },
          "user": { "type": "string" },
          "items": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "product": { "type": "string" },
                "quantity": { "type": "integer" },
                "price": { "type": "number" }
              }
            }
          },
          "address": { "$ref": "#/components/schemas/Address" },
          "deliveryOption": { "$ref": "#/components/schemas/DeliveryOption" },
          "payment": { "type": "string" },
          "status": { "type": "string" },
          "total": { "type": "number" }
        }
      },
      "Payment": {
        "type": "object",
        "properties": {
          "id": { "type": "string" },
          "user": { "type": "string" },
          "order": { "type": "string" },
          "amount": { "type": "number" },
          "method": { "type": "string" },
          "status": { "type": "string" }
        }
      }
    }
  },
  "security": [{ "bearerAuth": [] }],
  "paths": {
    "/auth/register": {
      "post": {
        "tags": ["Auth"],
        "summary": "Register a new user",
        "requestBody": { "required": true, "content": { "application/json": { "schema": { "$ref": "#/components/schemas/User" } } } },
        "responses": { "200": { "description": "User registered" } }
      }
    },
    "/auth/login": {
      "post": {
        "tags": ["Auth"],
        "summary": "Login user",
        "requestBody": { "required": true, "content": { "application/json": { "schema": { "type": "object", "properties": { "email": { "type": "string" }, "password": { "type": "string" } } } } } },
        "responses": { "200": { "description": "User logged in" } }
      }
    },
    "/auth/google": {
      "post": {
        "tags": ["Auth"],
        "summary": "Google OAuth login/register",
        "requestBody": { "required": true, "content": { "application/json": { "schema": { "type": "object", "properties": { "googleId": { "type": "string" }, "email": { "type": "string" }, "name": { "type": "string" } } } } } },
        "responses": { "200": { "description": "Google user authenticated" } }
      }
    },
    "/products": {
      "get": { "tags": ["Products"], "summary": "List products", "responses": { "200": { "description": "List of products" } } },
      "post": { "tags": ["Products"], "summary": "Create product", "requestBody": { "required": true, "content": { "multipart/form-data": { "schema": { "$ref": "#/components/schemas/Product" } } } }, "responses": { "201": { "description": "Product created" } } }
    },
    "/products/{id}": {
      "get": { "tags": ["Products"], "summary": "Get product by ID", "parameters": [{ "name": "id", "in": "path", "required": true, "schema": { "type": "string" } }], "responses": { "200": { "description": "Product" } } },
      "put": { "tags": ["Products"], "summary": "Update product", "parameters": [{ "name": "id", "in": "path", "required": true, "schema": { "type": "string" } }], "requestBody": { "required": true, "content": { "multipart/form-data": { "schema": { "$ref": "#/components/schemas/Product" } } } }, "responses": { "200": { "description": "Product updated" } } },
      "delete": { "tags": ["Products"], "summary": "Delete product", "parameters": [{ "name": "id", "in": "path", "required": true, "schema": { "type": "string" } }], "responses": { "200": { "description": "Product deleted" } } }
    },
    "/categories": {
      "get": { "tags": ["Categories"], "summary": "List categories", "responses": { "200": { "description": "List of categories" } } },
      "post": { "tags": ["Categories"], "summary": "Create category", "requestBody": { "required": true, "content": { "application/json": { "schema": { "$ref": "#/components/schemas/Category" } } } }, "responses": { "201": { "description": "Category created" } } }
    },
    "/categories/{id}": {
      "get": { "tags": ["Categories"], "summary": "Get category by ID", "parameters": [{ "name": "id", "in": "path", "required": true, "schema": { "type": "string" } }], "responses": { "200": { "description": "Category" } } },
      "put": { "tags": ["Categories"], "summary": "Update category", "parameters": [{ "name": "id", "in": "path", "required": true, "schema": { "type": "string" } }], "requestBody": { "required": true, "content": { "application/json": { "schema": { "$ref": "#/components/schemas/Category" } } } }, "responses": { "200": { "description": "Category updated" } } },
      "delete": { "tags": ["Categories"], "summary": "Delete category", "parameters": [{ "name": "id", "in": "path", "required": true, "schema": { "type": "string" } }], "responses": { "200": { "description": "Category deleted" } } }
    },
    "/subcategories": {
      "get": { "tags": ["Subcategories"], "summary": "List subcategories", "responses": { "200": { "description": "List of subcategories" } } },
      "post": { "tags": ["Subcategories"], "summary": "Create subcategory", "requestBody": { "required": true, "content": { "application/json": { "schema": { "$ref": "#/components/schemas/Subcategory" } } } }, "responses": { "201": { "description": "Subcategory created" } } }
    },
    "/subcategories/{id}": {
      "get": { "tags": ["Subcategories"], "summary": "Get subcategory by ID", "parameters": [{ "name": "id", "in": "path", "required": true, "schema": { "type": "string" } }], "responses": { "200": { "description": "Subcategory" } } },
      "put": { "tags": ["Subcategories"], "summary": "Update subcategory", "parameters": [{ "name": "id", "in": "path", "required": true, "schema": { "type": "string" } }], "requestBody": { "required": true, "content": { "application/json": { "schema": { "$ref": "#/components/schemas/Subcategory" } } } }, "responses": { "200": { "description": "Subcategory updated" } } },
      "delete": { "tags": ["Subcategories"], "summary": "Delete subcategory", "parameters": [{ "name": "id", "in": "path", "required": true, "schema": { "type": "string" } }], "responses": { "200": { "description": "Subcategory deleted" } } }
    },
    "/cart": {
      "get": { "tags": ["Cart"], "summary": "Get user cart", "responses": { "200": { "description": "Cart" } } }
    },
    "/cart/add": {
      "post": { "tags": ["Cart"], "summary": "Add item to cart", "requestBody": { "required": true, "content": { "application/json": { "schema": { "type": "object", "properties": { "productId": { "type": "string" }, "quantity": { "type": "integer" } } } } } }, "responses": { "200": { "description": "Item added to cart" } } }
    },
    "/cart/update": {
      "put": { "tags": ["Cart"], "summary": "Update cart item quantity", "requestBody": { "required": true, "content": { "application/json": { "schema": { "type": "object", "properties": { "productId": { "type": "string" }, "quantity": { "type": "integer" } } } } } }, "responses": { "200": { "description": "Cart item updated" } } }
    },
    "/cart/remove": {
      "delete": { "tags": ["Cart"], "summary": "Remove item from cart", "requestBody": { "required": true, "content": { "application/json": { "schema": { "type": "object", "properties": { "productId": { "type": "string" } } } } } }, "responses": { "200": { "description": "Item removed from cart" } } }
    },
    "/cart/clear": {
      "delete": { "tags": ["Cart"], "summary": "Clear cart", "responses": { "200": { "description": "Cart cleared" } } }
    },
    "/delivery/address": {
      "post": { "tags": ["Delivery"], "summary": "Create address", "requestBody": { "required": true, "content": { "application/json": { "schema": { "$ref": "#/components/schemas/Address" } } } }, "responses": { "201": { "description": "Address created" } } },
      "get": { "tags": ["Delivery"], "summary": "List addresses", "responses": { "200": { "description": "List of addresses" } } }
    },
    "/delivery/address/{id}": {
      "get": { "tags": ["Delivery"], "summary": "Get address by ID", "parameters": [{ "name": "id", "in": "path", "required": true, "schema": { "type": "string" } }], "responses": { "200": { "description": "Address" } } },
      "put": { "tags": ["Delivery"], "summary": "Update address", "parameters": [{ "name": "id", "in": "path", "required": true, "schema": { "type": "string" } }], "requestBody": { "required": true, "content": { "application/json": { "schema": { "$ref": "#/components/schemas/Address" } } } }, "responses": { "200": { "description": "Address updated" } } },
      "delete": { "tags": ["Delivery"], "summary": "Delete address", "parameters": [{ "name": "id", "in": "path", "required": true, "schema": { "type": "string" } }], "responses": { "200": { "description": "Address deleted" } } }
    },
    "/delivery/option": {
      "post": { "tags": ["Delivery"], "summary": "Create delivery option (admin)", "requestBody": { "required": true, "content": { "application/json": { "schema": { "$ref": "#/components/schemas/DeliveryOption" } } } }, "responses": { "201": { "description": "Delivery option created" } } },
      "get": { "tags": ["Delivery"], "summary": "List delivery options", "responses": { "200": { "description": "List of delivery options" } } }
    },
    "/delivery/option/{id}": {
      "get": { "tags": ["Delivery"], "summary": "Get delivery option by ID", "parameters": [{ "name": "id", "in": "path", "required": true, "schema": { "type": "string" } }], "responses": { "200": { "description": "Delivery option" } } },
      "put": { "tags": ["Delivery"], "summary": "Update delivery option (admin)", "parameters": [{ "name": "id", "in": "path", "required": true, "schema": { "type": "string" } }], "requestBody": { "required": true, "content": { "application/json": { "schema": { "$ref": "#/components/schemas/DeliveryOption" } } } }, "responses": { "200": { "description": "Delivery option updated" } } },
      "delete": { "tags": ["Delivery"], "summary": "Delete delivery option (admin)", "parameters": [{ "name": "id", "in": "path", "required": true, "schema": { "type": "string" } }], "responses": { "200": { "description": "Delivery option deleted" } } }
    },
    "/orders": {
      "post": { "tags": ["Orders"], "summary": "Place order", "requestBody": { "required": true, "content": { "application/json": { "schema": { "type": "object", "properties": { "addressId": { "type": "string" }, "deliveryOptionId": { "type": "string" } } } } } }, "responses": { "201": { "description": "Order placed" } } },
      "get": { "tags": ["Orders"], "summary": "List user orders", "responses": { "200": { "description": "List of orders" } } }
    },
    "/orders/{id}": {
      "get": { "tags": ["Orders"], "summary": "Get order by ID", "parameters": [{ "name": "id", "in": "path", "required": true, "schema": { "type": "string" } }], "responses": { "200": { "description": "Order" } } },
      "put": { "tags": ["Orders"], "summary": "Update order status (admin)", "parameters": [{ "name": "id", "in": "path", "required": true, "schema": { "type": "string" } }], "requestBody": { "required": true, "content": { "application/json": { "schema": { "type": "object", "properties": { "status": { "type": "string" } } } } } }, "responses": { "200": { "description": "Order status updated" } } },
      "delete": { "tags": ["Orders"], "summary": "Cancel order", "parameters": [{ "name": "id", "in": "path", "required": true, "schema": { "type": "string" } }], "responses": { "200": { "description": "Order cancelled" } } }
    },
    "/payments": {
      "post": { "tags": ["Payments"], "summary": "Create payment for order", "requestBody": { "required": true, "content": { "application/json": { "schema": { "type": "object", "properties": { "orderId": { "type": "string" }, "amount": { "type": "number" }, "method": { "type": "string" } } } } } }, "responses": { "201": { "description": "Payment created" } } },
      "get": { "tags": ["Payments"], "summary": "List user payments", "responses": { "200": { "description": "List of payments" } } }
    },
    "/payments/{id}": {
      "get": { "tags": ["Payments"], "summary": "Get payment by ID", "parameters": [{ "name": "id", "in": "path", "required": true, "schema": { "type": "string" } }], "responses": { "200": { "description": "Payment" } } },
      "put": { "tags": ["Payments"], "summary": "Update payment status (admin)", "parameters": [{ "name": "id", "in": "path", "required": true, "schema": { "type": "string" } }], "requestBody": { "required": true, "content": { "application/json": { "schema": { "type": "object", "properties": { "status": { "type": "string" } } } } } }, "responses": { "200": { "description": "Payment status updated" } } }
    },
    "/payments/payfast-url": {
      "post": { "tags": ["PayFast"], "summary": "Get PayFast payment URL for order", "requestBody": { "required": true, "content": { "application/json": { "schema": { "type": "object", "properties": { "orderId": { "type": "string" } } } } } }, "responses": { "200": { "description": "PayFast payment URL" } } }
    },
    "/payments/payfast-itn": {
      "post": { "tags": ["PayFast"], "summary": "PayFast ITN webhook", "requestBody": { "required": true, "content": { "application/x-www-form-urlencoded": { "schema": { "type": "object" } } } }, "responses": { "200": { "description": "ITN received" } } }
    }
  }
} 